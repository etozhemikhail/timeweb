pipeline {
    agent any

    stages {
        stage('Generate parameters') {
            steps {
                script {
                    dir('helms') {
                        def params = [:]
                        def dirs = fileTree(dir: '.', excludes: ['**/.svn', '**/.git'])
                        dirs.each { dir ->
                            def appName = dir.name
                            params["url-${appName}"] = [string(name: "url-${appName}", defaultValue: '', description: "URL for ${appName}")]
                            params["deploy-url-${appName}"] = [booleanParam(name: "deploy-url-${appName}", defaultValue: false, description: "Deploy ${appName}?")]
                        }
                        // You can't use the `properties` step here. Instead, you can use the `parameters` directive to define parameters for your pipeline.
                        pipelineParameters(params)
                    }
                }
            }
        }
    }
}